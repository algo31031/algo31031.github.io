<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: 测试 cucumber | 老男孩的整理箱]]></title>
  <link href="http://blog.sns-simple.com/blog/categories/ce-shi-cucumber/atom.xml" rel="self"/>
  <link href="http://blog.sns-simple.com/"/>
  <updated>2014-04-08T16:35:30+08:00</updated>
  <id>http://blog.sns-simple.com/</id>
  <author>
    <name><![CDATA[banban]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[使用cucumber配合pickle]]></title>
    <link href="http://blog.sns-simple.com/blog/2011/01/27/shi-yong-cucumberpei-he-pickle/"/>
    <updated>2011-01-27T21:58:00+08:00</updated>
    <id>http://blog.sns-simple.com/blog/2011/01/27/shi-yong-cucumberpei-he-pickle</id>
    <content type="html"><![CDATA[<p>建立项目</p>

<pre><code>$ rails -d mysql order test
</code></pre>

<p>添加脚手架</p>

<pre><code>$ ruby script/generate scaffold books title:string
</code></pre>

<p>创建数据库，建表</p>

<p>修改<code>BooksController#index</code></p>

<pre><code>@books = Book.find(:all,:order =&gt; "title DESC")
</code></pre>

<p>在项目下加载cucumber与capybara</p>

<pre><code>ruby script/generate cucumber --capybara
</code></pre>

<p>添加pickle(path可选，加上之后会在paths.rb里面增加)</p>

<pre><code>ruby script/generate pickle path    
</code></pre>

<p>在相应books_steps.rb文件里加入</p>

<pre><code>Then /^我应该(?:在"([^"]*)"中)?依次看到:$/ do |selector, table|
  pattern = table.raw.flatten.collect(&amp;Regexp.method(:quote)).join('.*?')
  regexp = Regexp.compile(pattern, Regexp::MULTILINE)
  with_scope(selector) do
    page.should have_xpath('//*', :text =&gt; regexp)
  end
end
</code></pre>

<p>在feature中加入</p>

<pre><code>Scenario: books in order
Given the following books exist
  | title   | id |
  | aaa  | 1  |
  | bbb  | 2  |
  | ccc   | 3  |
When I go to books
Then I should see in that order:
  | ccc    |
  | bbb    | 
  | aaa    | 
And I should see "aaa" 
</code></pre>

<p>在paths.rb中加入</p>

<pre><code>when /books/
  books_path
</code></pre>

<p>运行</p>

<pre><code>$ rake cucumber:all
</code></pre>

<p>等着看黄瓜变绿～～</p>
]]></content>
  </entry>
  
</feed>
